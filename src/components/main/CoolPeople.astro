---
import RegularBox from '@com/main/RegularBox.astro';
import OtherProfileImage from "@com/main/OtherProfileImage.astro";

interface Props {
  loggedin?: boolean;
  profilepic?: boolean;
  name?: string;
  username: string;
}

import { Icon } from 'astro-icon/components';

const { name, username, profilepic, loggedin } = Astro.props;

// Array of possible names and photo URLs
const names = ['Alex', 'Jordan', 'Taylor', 'Morgan', 'Jamie', 'Casey', 'Riley', 'Cameron', 'Avery', 'Rowan'];
const photos = [
  "https://i.pravatar.cc/88?img=3",
  "https://i.pravatar.cc/88?img=5",
  "https://i.pravatar.cc/88?img=7",
  "https://i.pravatar.cc/88?img=9",
  "https://i.pravatar.cc/88?img=11",
  "https://i.pravatar.cc/88?img=13",
  "https://i.pravatar.cc/88?img=15",
  "https://i.pravatar.cc/88?img=17",
  "https://i.pravatar.cc/88?img=19",
  "https://i.pravatar.cc/88?img=21"
];

// Shuffle function to randomize arrays
const shuffleArray = (array) => {
  let shuffledArray = array.slice(); // Copy the array
  for (let i = shuffledArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j], shuffledArray[i]]; // Swap elements
  }
  return shuffledArray;
};

// Shuffle names and photos and select the first 4
const randomNames = shuffleArray(names).slice(0, 4);
const randomPhotos = shuffleArray(photos).slice(0, 4);
---

<RegularBox 
  name="Cool New People" 
  name2="[view more]" 
  pclass="flex items-center justify-between mx-2 text-xs text-white font-semibold mt-0.5" 
  backgroundColor="bg-[#252728]"
  borderColor="border-[#252728]" 
  aclass="text-[10px] -mt-0.5 font-normal hover:underline text-white" 
  aurl="/browse"
>
  <div class="flex items-start justify-center mb-1.5 mt-0.5 gap-x-[34px] relative group">
    {randomNames.map((randomName, index) => (
      <a href={`/${username}`} target="_self" title={`Visit ${randomName}'s profile`}>
        <div class="flex items-center justify-center flex-col hover:underline text-xs font-semibold text-[#252728] hover:text-red-600">
          <p class="mb-0.5">{randomName}</p>
          { profilepic ?
                  <OtherProfileImage
                  width={88}
                  height={88}
                  srcurl={randomPhotos[index]}
                  altText={`${randomName}'s profile picture`}
                  titleText={`Visit ${randomName}'s profile`}
                  loggedin={loggedin}
                />
                :
                <div class="relative">
                  <Icon class="w-[88px] h-auto" name="avatar" />
                    { loggedin && <div class="absolute bottom-0 right-0 block w-[20px] h-[20px] rounded-full bg-green-500 border-[2px] border-white -mb-1 -mr-1">
                    </div>}
                </div>
              }
        </div>
      </a>
    ))}
</div>
</RegularBox>
