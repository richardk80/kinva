---
import NonRegularBox from '@com/main/NonRegularBox.astro';
import ProfileImage from '@com/main/ProfileImage.astro';
import TopRightUserDetailLinks from '@com/home/TopRightUserDetailLinks.astro';

import { Icon } from 'astro-icon/components';

const { name, username } = Astro.props;

import onlineusers from '../../pages/api/users';

// Find the current user details
const currentUser = onlineusers.find(user => user.username === username);

// Check if the user has a profile picture
const hasProfilePic = currentUser ? currentUser.profilepic : false;

//let parts = name.split(' ')
//let firstName = parts.shift();
//let lastName = parts.join(' ');
---
<NonRegularBox
    widthcss="w-[304px]" 
    name={`Hello ${name}!`}
    pclass="flex items-center ml-2 text-base font-semibold text-white mt-0.5 h-6" 
    backgroundColor="bg-[#252728]" 
    borderColor="border-[#252728]/80"
>
        <div class="mx-2 mt-2 space-y-1">
            <div class="flex justify-between">
                <a href={`/${username}`}>
                    {hasProfilePic ? (
                        <ProfileImage
                          width={160}
                          height={160}
                          srcurl="https://i.pravatar.cc/160?img=3"
                          altText="Dex's profile picture"
                          titleText="Visit Dex's Profile Page"
                        />
                      ) : (
                        <Icon class="w-[160px] h-[160px] mb-1.5" name="avatar" />
                      )}
                </a>
                <TopRightUserDetailLinks username={username} />
            </div>
        </div>
</NonRegularBox>