---
import RegularBox from '@com/main/RegularBox.astro';

// Initialize the bulletins array with Date objects
const friendbulletins = [
  { from: 'Stanley', subject: `What's going on with my life right now ha ha ha ha ha ha`, date: new Date('2024-09-15') },
  { from: 'Rodney', subject: `What's going on with my life right now ha ha`, date: new Date('2024-09-14') },
  { from: 'Norman', subject: `What's going on with my life right now ha ha ha ha ha ha`, date: new Date('2024-09-13') },
  { from: 'Mike', subject: `What's going on with my life right now ha ha`, date: new Date('2024-09-12') },
  { from: 'Jacob', subject: `What's going on with my life right now ha ha ha ha ha ha`, date: new Date('2024-09-11') },
];

// Set the number of bulletins to display and the max limit
const maxBulletinsToShow = 5;  // The maximum limit of bulletins to show

// Sort bulletins by date in descending order
const sortedBulletins = friendbulletins.sort((a, b) => b.date.getTime() - a.date.getTime());
const displayedBulletins = sortedBulletins.slice(0, Math.min(maxBulletinsToShow, maxBulletinsToShow));

const hasBulletins = displayedBulletins.length > 0;
---
<RegularBox 
  name="Your Friend's Bulletins" 
  name2="[view all]"  
  pclass="flex items-center justify-between mx-2 text-xs text-white font-semibold mt-0.5 flex flex-grow" 
  backgroundColor="bg-neutral-950" 
  borderColor="border-b-0 border-neutral-950"
  aclass="text-[10px] -mt-0.5 font-normal hover:underline text-white" 
  aurl="/bulletins"
>
  <div>
    {hasBulletins ? 
      <div>
        <div class="grid grid-cols-5 border-b border-neutral-950 flex items-center">
          <div class="py-1 col-span-1 border-r border-neutral-950">
            <h2 class="text-xs font-semibold pl-2">From:</h2>
          </div>
          <div class="py-1 col-span-4">
            <h2 class="text-xs font-semibold pl-2">Subject:</h2>
          </div>
        </div>
        {displayedBulletins.map(bulletin => (
          <div class="grid grid-cols-5 flex items-center border-b overflow-hidden border-neutral-950">
            <div class="py-1 pl-2 col-span-1 border-r flex overflow-hidden border-neutral-950">
              <a href="#" class="text-xs text-neutral-950 hover:text-red-600 hover:underline truncate">{bulletin.from}</a>
            </div>
            <div class="py-1 pl-2 col-span-4 flex overflow-x-auto">
              <a href="#" class="text-xs hover:text-red-600 hover:underline truncate">{bulletin.subject}</a>
            </div>
          </div>
        ))}
      </div>
      :
      <div class="grid grid-cols-3 border-b-2 border-neutral-950">
        <div class="py-1 col-span-3">
          <div class="text-xs flex items-center justify-center pt-0.5">
            <p class="font-semibold">No Bulletins -</p>
            <a class="text-neutral-950 hover:text-red-600 ml-1 hover:underline font-normal" href="/browse">
              Add New Friends
            </a>
          </div>
        </div>
      </div>
    }
  </div>
</RegularBox>